<!--
  ~
  ~  CLOUDERA DATAPLANE SERVICE AND ITS CONSTITUENT SERVICES
  ~
  ~  (c) 2016-2018 Cloudera, Inc. All rights reserved.
  ~
  ~  This code is provided to you pursuant to your written agreement with Cloudera, which may be the terms of the
  ~  Affero General Public License version 3 (AGPLv3), or pursuant to a written agreement with a third party authorized
  ~  to distribute this code.  If you do not have a written agreement with Cloudera or with an authorized and
  ~  properly licensed third party, you do not have any rights to this code.
  ~
  ~  If this code is provided to you under the terms of the AGPLv3:
  ~  (A) CLOUDERA PROVIDES THIS CODE TO YOU WITHOUT WARRANTIES OF ANY KIND;
  ~  (B) CLOUDERA DISCLAIMS ANY AND ALL EXPRESS AND IMPLIED WARRANTIES WITH RESPECT TO THIS CODE, INCLUDING BUT NOT
  ~    LIMITED TO IMPLIED WARRANTIES OF TITLE, NON-INFRINGEMENT, MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE;
  ~  (C) CLOUDERA IS NOT LIABLE TO YOU, AND WILL NOT DEFEND, INDEMNIFY, OR HOLD YOU HARMLESS FOR ANY CLAIMS ARISING
  ~    FROM OR RELATED TO THE CODE; AND
  ~  (D) WITH RESPECT TO YOUR EXERCISE OF ANY RIGHTS GRANTED TO YOU FOR THE CODE, CLOUDERA IS NOT LIABLE FOR ANY
  ~    DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, PUNITIVE OR CONSEQUENTIAL DAMAGES INCLUDING, BUT NOT LIMITED TO,
  ~    DAMAGES RELATED TO LOST REVENUE, LOST PROFITS, LOSS OF INCOME, LOSS OF BUSINESS ADVANTAGE OR UNAVAILABILITY,
  ~    OR LOSS OR CORRUPTION OF DATA.
  ~
  -->
<div class="mdl-cell mdl-cell--12-col mdl-cell--12-col-tablet brush-wrapper brush-fixed-pos" [ngClass]="{'hidden': stages.length === 0}">
  <div class="mdl-padded__container">
    <div id="brush"></div>
  </div>
</div>
<div class="mdl-cell mdl-cell--12-col mdl-cell--12-col-tablet mdl-color--white m-t-55">
  <mat-error *ngIf="stageApiErrorMessage" class="alert error">
    {{stageApiErrorMessage}}
  </mat-error>
  <div class="mdl-padded__container" #dagChildView>
    <div class="dag-header">
      <h5 class="dag-title">Stages</h5>
      <div class="sort-container">
        <span>Sort by : </span>
        <button mat-flat-button [matMenuTriggerFor]="sortByDropdown">
          <span>
            {{getSelectedSortLabel()}}
            <div *ngIf="sortType==='asc';then arrowdown else arrowup"></div>
            <ng-template #arrowup>
              <i class="fa fa-arrow-up active"></i>
            </ng-template>
            <ng-template #arrowdown>
              <i class="fa fa-arrow-down active"></i>
            </ng-template>
          </span>
        </button>
        <mat-menu #sortByDropdown="matMenu">
          <button mat-menu-item class="sort-option" *ngFor="let option of sortOptions" (click)="onSort(option.key)">
            <span>{{option.label}}
              <div *ngIf="sortBy===option.key;then sorted else sortable"></div>
              <ng-template #sorted>
                <div *ngIf="sortType==='asc';then arrowdown else arrowup"></div>
              </ng-template>
              <ng-template #sortable>
                <i class="fa fa-sort"></i>
              </ng-template>
            </span>
          </button>
        </mat-menu>
      </div>
    </div>
    <!--<div class="mdl-dag__button"><i class="fa fa-compress"></i></div>-->
    <div id="legend"></div>
    <div id="swimlane"></div>
    <div id="xAxis"></div>
  </div>
  <div *ngIf="showSelectedStageInfo" class="mdl-padded__container stage-info">
    <des-stage-info [sqlPlanUpdates]="sqlPlanUpdates" [selectedStage]="selectedStage" [analysisState]="analysisState" (messageEvent)="closeStageInfo($event)"
      [stageAnlaysis]="false"></des-stage-info>
  </div>
</div>
